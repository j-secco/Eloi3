# ============================================================================
# UR10 Robot Kiosk - Security Headers Configuration
# ============================================================================
# This file contains security header configurations for nginx, Apache, and
# application-level security settings.
# ============================================================================

# Content Security Policy (CSP)
# Restricts resource loading to prevent XSS attacks
CSP_POLICY="default-src 'self'; \
    script-src 'self' 'unsafe-inline' 'unsafe-eval'; \
    style-src 'self' 'unsafe-inline'; \
    img-src 'self' data: blob:; \
    font-src 'self' data:; \
    connect-src 'self' ws: wss:; \
    media-src 'self'; \
    object-src 'none'; \
    frame-src 'none'; \
    base-uri 'self'; \
    form-action 'self'"

# HTTP Strict Transport Security (HSTS)
# Forces HTTPS connections
HSTS_POLICY="max-age=31536000; includeSubDomains; preload"

# X-Frame-Options
# Prevents clickjacking attacks
FRAME_OPTIONS="DENY"

# X-Content-Type-Options
# Prevents MIME type sniffing
CONTENT_TYPE_OPTIONS="nosniff"

# X-XSS-Protection
# Enables XSS filtering
XSS_PROTECTION="1; mode=block"

# Referrer Policy
# Controls referrer information
REFERRER_POLICY="strict-origin-when-cross-origin"

# Permissions Policy (formerly Feature Policy)
# Controls browser features
PERMISSIONS_POLICY="geolocation=(), microphone=(), camera=(), payment=(), usb=(), magnetometer=(), gyroscope=(), accelerometer=()"

# CORS Configuration
# Cross-Origin Resource Sharing settings
CORS_ALLOWED_ORIGINS="https://localhost:5173,https://ur10-kiosk.local:5173,https://127.0.0.1:5173"
CORS_ALLOWED_METHODS="GET,POST,PUT,DELETE,OPTIONS,PATCH"
CORS_ALLOWED_HEADERS="Content-Type,Authorization,X-Requested-With,Accept,Origin,Access-Control-Request-Method,Access-Control-Request-Headers"
CORS_ALLOW_CREDENTIALS="true"
CORS_MAX_AGE="86400"

# Private Network Access
# Required for accessing local network resources from HTTPS
PRIVATE_NETWORK_ACCESS="true"

# Robot Server CORS Settings
ROBOT_SERVER_CORS_ORIGINS="https://localhost:5173,https://ur10-kiosk.local:5173"
ROBOT_SERVER_CORS_METHODS="GET,POST,PUT,DELETE,OPTIONS"
ROBOT_SERVER_CORS_HEADERS="Content-Type,Authorization,X-Requested-With"

# WebSocket CORS Settings
WEBSOCKET_CORS_ORIGINS="https://localhost:5173,https://ur10-kiosk.local:5173"
WEBSOCKET_CORS_CREDENTIALS="true"

# TLS Configuration
TLS_MIN_VERSION="1.2"
TLS_CIPHERS="ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384"
TLS_PROTOCOLS="TLSv1.2 TLSv1.3"

# Session Security
SESSION_COOKIE_SECURE="true"
SESSION_COOKIE_HTTPONLY="true"
SESSION_COOKIE_SAMESITE="Strict"
SESSION_TIMEOUT="3600"  # 1 hour

# Rate Limiting
RATE_LIMIT_REQUESTS="100"
RATE_LIMIT_WINDOW="60"  # seconds
RATE_LIMIT_BURST="20"

# IP Whitelist (optional)
# Comma-separated list of allowed IP addresses/ranges
IP_WHITELIST="127.0.0.1,::1,192.168.1.0/24,10.0.0.0/8"

# Security Logging
SECURITY_LOG_LEVEL="INFO"
SECURITY_LOG_FILE="/var/log/ur10-kiosk/security.log"
AUDIT_LOG_ENABLED="true"
AUDIT_LOG_FILE="/var/log/ur10-kiosk/audit.log"

